apiVersion: backstage.io/v1beta1
kind: Template
metadata:
  name: test-template-v2
  title: Test Template v2
  description: Testing out the new template schema
spec:
  owner: backstage/techdocs-core
  type: service

  parameters:
    required:
      - name
    properties:
      name:
        title: Name
        type: string
        description: Unique name of the component
        ui:widget: textarea
        ui:options:
          rows: 5
      storePath: # provides {owner, repository, providerUrl}
        # $ref: '#/definitions/StorePath'
        title: Store Path
        type: string
        description: Copy https://github.com/aeothgiaetgh/aetkijhahte and hammer in some more letters

  steps:
    - id: prepare
      action: legacy:prepare
      parameters:
        protocol: file
        url: /Users/patriko/dev/backstage/plugins/scaffolder-backend/sample-templates/test-template-v2
    - id: template
      action: legacy:template
      parameters:
        templater: cookiecutter
        values:
          name: '{{ parameters.name }}'
    - id: publish
      action: legacy:publish
      parameters:
        values:
          name: '{{ parameters.name }}'
          storePath: '{{ parameters.storePath }}'
          owner: kungen # not use
    - id: register
      action: catalog:register
      parameters:
        catalogInfoUrl: '{{ steps.publish.output.catalogInfoUrl }}'

  output:
    catalogInfoUrl: '{{ steps.publish.output.catalogInfoUrl }}'
    entityRef: '{{ steps.register.entityRef }}'
